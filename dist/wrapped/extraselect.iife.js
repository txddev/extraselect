var Extraselect=function(P,e){"use strict";const _=new WeakMap;class N{static put(l,t,r){_.has(l)||_.set(l,new Map),_.get(l).set(t,r)}static get(l,t){return _.get(l).get(t)}static has(l,t){return _.has(l)&&_.get(l).has(t)}static remove(l,t){var r=_.get(l).delete(t);return _.get(l).size!==0&&_.delete(l),r}static lock(l,t,r){if(!N.has(l,t)){N.put(l,t,!0);const o=r();return o!==void 0&&N.put(l,t,o),o}return!1}static async lockAsync(l,t,r){if(!N.has(l,t)){N.put(l,t,!0);const o=await r();return o!==void 0&&N.put(l,t,o),o}return!1}}({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}).DATASTORE_DEBUG&&(window.__Store=_);function H(n){if(n==null)return{top:0,left:0,width:null,height:null};let l=n.getBoundingClientRect();return{top:l.top+window.scrollY,left:l.left+window.scrollX,width:l.width,height:l.height}}function A(n,l){l===void 0&&(l=window.document);for(var t=[],r=n.parentNode;r!=null&&r instanceof HTMLElement&&!(l instanceof HTMLElement&&r===l)&&!(typeof l=="string"&&r.matches(l));){var o=r;t.push(o),r=o.parentNode}return r!=null&&t.push(r),t}function ge(n){var l=Array.prototype.slice.call(n.childNodes);l.forEach(function(t){n.removeChild(t)})}function ye(n){return e.getCurrentScope()?(e.onScopeDispose(n),!0):!1}function J(n){return typeof n=="function"?n():e.unref(n)}const we=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;function ke(n){return e.getCurrentInstance()}function ve(n,l=!0,t){ke()?e.onMounted(n,t):l?n():e.nextTick(n)}const K=we?window:void 0;function z(n){var l;const t=J(n);return(l=t==null?void 0:t.$el)!=null?l:t}function Ee(){const n=e.ref(!1),l=e.getCurrentInstance();return l&&e.onMounted(()=>{n.value=!0},l),n}function be(n){const l=Ee();return e.computed(()=>(l.value,!!n()))}function Se(n,l,t={}){const{window:r=K,...o}=t;let a;const f=be(()=>r&&"ResizeObserver"in r),i=()=>{a&&(a.disconnect(),a=void 0)},g=e.computed(()=>{const c=J(n);return Array.isArray(c)?c.map(d=>z(d)):[z(c)]}),s=e.watch(g,c=>{if(i(),f.value&&r){a=new ResizeObserver(l);for(const d of c)d&&a.observe(d,o)}},{immediate:!0,flush:"post"}),m=()=>{i(),s()};return ye(m),{isSupported:f,stop:m}}function xe(n,l={width:0,height:0},t={}){const{window:r=K,box:o="content-box"}=t,a=e.computed(()=>{var c,d;return(d=(c=z(n))==null?void 0:c.namespaceURI)==null?void 0:d.includes("svg")}),f=e.ref(l.width),i=e.ref(l.height),{stop:g}=Se(n,([c])=>{const d=o==="border-box"?c.borderBoxSize:o==="content-box"?c.contentBoxSize:c.devicePixelContentBoxSize;if(r&&a.value){const u=z(n);if(u){const y=u.getBoundingClientRect();f.value=y.width,i.value=y.height}}else if(d){const u=Array.isArray(d)?d:[d];f.value=u.reduce((y,{inlineSize:w})=>y+w,0),i.value=u.reduce((y,{blockSize:w})=>y+w,0)}else f.value=c.contentRect.width,i.value=c.contentRect.height},t);ve(()=>{const c=z(n);c&&(f.value="offsetWidth"in c?c.offsetWidth:l.width,i.value="offsetHeight"in c?c.offsetHeight:l.height)});const s=e.watch(()=>z(n),c=>{f.value=c?l.width:0,i.value=c?l.height:0});function m(){g(),s()}return{width:f,height:i,stop:m}}function X(n,l){const{containerStyle:t,wrapperProps:r,scrollTo:o,calculateRange:a,currentList:f,containerRef:i}="itemHeight"in l?Be(l,n):Ne(l,n);return{list:f,scrollTo:o,containerProps:{ref:i,onScroll:()=>{a()},style:t},wrapperProps:r}}function Y(n){const l=e.ref(null),t=xe(l),r=e.ref([]),o=e.shallowRef(n);return{state:e.ref({start:0,end:10}),source:o,currentList:r,size:t,containerRef:l}}function Q(n,l,t){return r=>{if(typeof t=="number")return Math.ceil(r/t);const{start:o=0}=n.value;let a=0,f=0;for(let i=o;i<l.value.length;i++){const g=t(i);if(a+=g,f=i,a>r)break}return f-o}}function Z(n,l){return t=>{if(typeof l=="number")return Math.floor(t/l)+1;let r=0,o=0;for(let a=0;a<n.value.length;a++){const f=l(a);if(r+=f,r>=t){o=a;break}}return o+1}}function ee(n,l,t,r,{containerRef:o,state:a,currentList:f,source:i}){return()=>{const g=o.value;if(g){const s=t(n==="vertical"?g.scrollTop:g.scrollLeft),m=r(n==="vertical"?g.clientHeight:g.clientWidth),c=s-l,d=s+m+l;a.value={start:c<0?0:c,end:d>i.value.length?i.value.length:d},f.value=i.value.slice(a.value.start,a.value.end).map((u,y)=>({data:u,index:y+a.value.start}))}}}function te(n,l){return t=>typeof n=="number"?t*n:l.value.slice(0,t).reduce((o,a,f)=>o+n(f),0)}function ne(n,l,t,r){e.watch([n.width,n.height,l,t],()=>{r()})}function le(n,l){return e.computed(()=>typeof n=="number"?l.value.length*n:l.value.reduce((t,r,o)=>t+n(o),0))}const Ce={horizontal:"scrollLeft",vertical:"scrollTop"};function oe(n,l,t,r){return o=>{r.value&&(r.value[Ce[n]]=t(o),l())}}function Ne(n,l){const t=Y(l),{state:r,source:o,currentList:a,size:f,containerRef:i}=t,g={overflowX:"auto"},{itemWidth:s,overscan:m=5}=n,c=Q(r,o,s),d=Z(o,s),u=ee("horizontal",m,d,c,t),y=te(s,o),w=e.computed(()=>y(r.value.start)),k=le(s,o);ne(f,l,i,u);const B=oe("horizontal",u,y,i),V=e.computed(()=>({style:{height:"100%",width:`${k.value-w.value}px`,marginLeft:`${w.value}px`,display:"flex"}}));return{scrollTo:B,calculateRange:u,wrapperProps:V,containerStyle:g,currentList:a,containerRef:i}}function Be(n,l){const t=Y(l),{state:r,source:o,currentList:a,size:f,containerRef:i}=t,g={overflowY:"auto"},{itemHeight:s,overscan:m=5}=n,c=Q(r,o,s),d=Z(o,s),u=ee("vertical",m,d,c,t),y=te(s,o),w=e.computed(()=>y(r.value.start)),k=le(s,o);ne(f,l,i,u);const B=oe("vertical",u,y,i),V=e.computed(()=>({style:{width:"100%",height:`${k.value-w.value}px`,marginTop:`${w.value}px`}}));return{calculateRange:u,scrollTo:B,containerStyle:g,wrapperProps:V,currentList:a,containerRef:i}}const F=n=>{let l=parseInt(n);return l==n?l:n},Ve=n=>{try{var l=JSON.parse(n);if(l&&typeof l=="object")return l}catch{}return n},Le=(n,l,t)=>{window.ExtraSelectOptions==null&&(window.ExtraSelectOptions={});const r={defaultArray:n.value,get:()=>n.value,push:(o,a,f=null)=>{parseInt(o)==o&&(o=parseInt(o));const i=n.map.get(o);if(i)i.value=a,i.data=f;else{let g={value:a,key:o,data:f};n.value.push(g),n.map.set(g.key,g)}},addRange:o=>{for(let a of o)n.actions.push(a.key,a.value,a.data)},remove:o=>{n.value.splice(n.value.findIndex(a=>a.key==o),1)},clear:()=>{n.value=[]},sort:(o=null)=>{o==null&&(o=(a,f)=>a.value.localeCompare(f.value)),n.value=n.value.sort(o)},setDefault:function(o){this.defaultArray=o},restoreDefault:function(){n.value=this.defaultArray},filter:function(o){},selection:{get(){return l.value},clear(){l.value.clear()},add(o){l.value.set(o,o)},remove(o){l.value.delete(o)}}};window.ExtraSelectOptions[t]=r,n.actions=r};let _e=1;const ae=n=>{n&&(n.style.display="none",ge(n))},re=(n,l,t,r)=>{const o=e.ref(new Map);e.watchEffect(()=>{if(Array.isArray(t.value)){o.value.clear();for(let s of t.value)o.value.set(s,s)}});const a=e.ref([]);if(a.map=new Map,a.rebuildMap=()=>{if(a.map.clear(),a.value)for(let s of a.value)a.map.set(s.key,s)},e.watchEffect(()=>{l.value&&(a.value=l.value.map(s=>({...s,key:F(s.key)})),a.rebuildMap())}),n){if(o.value.clear(),n.matches("select")){for(let s of Array.apply(null,n.selectedOptions).map(m=>F(m.value)).filter(m=>m!=null))o.value.set(s,s);a.value=Array.apply(null,n.options).reduce((s,m)=>(s.push({value:m.text,key:F(m.value),data:Object.keys(m.dataset).reduce((c,d)=>(c[d]=Ve(m.dataset[d]),c),{})}),s),[])}if(n.matches("input")){let s=n.value;s!=null&&s.length>0&&(a.value=[{value:s,key:s}])}a.rebuildMap()}if(Array.isArray(r))for(let s of r)o.value.set(F(s),F(s));else r!=null&&o.value.set(F(r),F(r));let f=n==null?void 0:n.id;(f==null||f===""||f==0)&&(f="extraselect_"+(++_e).toString()),Le(a,o,f);const i=[];return o.value.forEach((s,m)=>{i.push([m,s])}),{options:a,selectedOptions:o,onReset:()=>{o.value.clear();for(let[s,m]of i)o.value.set(s,m)}}};e.ref({});function Oe(n,l={}){for(let t in l)n=n.replace(`:${t}`,l[t]);return n}const q=(n=null)=>{var r;window.ExtraSelectLocalization==null&&(window.ExtraSelectLocalization={});let t={...((r=window.ExtraSelectLocalization.defaults)==null?void 0:r.defaultArray)??{}};Object.assign(t,n??{}),se(e.ref(t),"defaults")},se=(n,l)=>{window.ExtraSelectLocalization==null&&(window.ExtraSelectLocalization={},q());const t={defaultArray:n.value,list:()=>n.value,get:r=>n.value[r]??null,push:(r,o)=>{n.value[r]=o}};window.ExtraSelectLocalization[l]=t,n.actions=t};let Te=0;const ie=(n,l)=>(se(l,(n==null?void 0:n.id)??"extraselect_"+(++Te).toString()),{propLocalization:l,t:(r,o={})=>{let a=l.value[r]??window.ExtraSelectLocalization.defaults.get(r);return a==null&&(window.ExtraSelectLocalization.defaults.push(r,r),a=r),Oe(a,o)}}),ce=async function(n,l=null,t={}){const r={method:"POST",credentials:"include",...t,headers:{"Content-Type":"application/json",...t.headers??{}},body:JSON.stringify({search:l,...t.body})};return await(await fetch(n,r)).json()},de=(n,l,t,r,o,a,f="limited",i={})=>{const g=e.ref(0),s=e.ref(!1),m=e.computed(()=>s.value||g.value>0);if(l!=null&&l.length>0)if(t){const c=[];e.watchEffect(d=>{if(r.value.length>=o){let u=!0;switch(f){case"always":break;default:case"limited":u=!c.includes(r.value);break;case"complete":u=c.reduce((y,w)=>y&&!r.value.startsWith(w),!0);break}if(u){s.value=!0;const y=setTimeout(()=>{c.push(r.value),g.value+=1,i.body={...i.body,...a.value},ce(l,r.value,i).then(w=>{n.actions.addRange(w),n.actions.sort(),g.value-=1,s.value=!1})},500);d(()=>{clearTimeout(y)})}}})}else ce(l,null,i).then(c=>{n.actions.addRange(c),n.actions.sort()});return{searchingFlag:m}},ue=(n,l,t,r=[],o=[])=>{const a=e.ref(""),f=e.ref([]),i=e.ref({}),g={...r.reduce((m,c)=>(m[c]=!1,m),{}),...o.reduce((m,c)=>(m[c]=!0,m),{})};for(let m in g){let c=g[m],d=document.getElementById(m);i.value[m]=d==null?void 0:d.value,d&&d.addEventListener("change",u=>{i.value[m]=u.target.value,c&&e.nextTick(()=>{if(l!=null)for(let y of Array.from(l.value.keys()))f.value.find(w=>w.key==y)||t(y,!1);else f.value.find(y=>y.key==a.value)||t(a.value,!1)})})}const s=function(m,c){let d=m.value;return Object.keys(i.value).length>0&&(d=d.filter(u=>{var y;for(let w in i.value)if((g[w]?!0:(i.value[w]??"").length>0)&&((y=u.data)!=null&&y.hasOwnProperty(w))){if(Array.isArray(u.data[w])){if(!u.data[w].includes(i.value[w]))return!1}else if(u.data[w]!=i.value[w])return!1}return!0})),c.length>0&&(d=d.filter(u=>u.value.toLowerCase().includes(c.toLowerCase()))),d};return e.watchEffect(()=>{f.value=s(n,a.value)}),{filterText:a,filteredOptions:f,filterValues:i}},fe=(n,l,t,r,o,a,f)=>{const i=getComputedStyle(document.querySelector("body")).font,g=function(c){const u=document.createElement("canvas").getContext("2d");return u.font=i,u.measureText(c).width},s=e.computed(()=>{const c=H(r.value).width??100;if(f==="inherit")return c;if(f==null||f==="dynamic"){const d=parseInt(getComputedStyle(document.querySelector("html"))["font-size"])??16;return Math.max(c,Math.max(...n.value.map(u=>g(u.value)))+20+d*3)}return f}),m=e.ref({position:"absolute","min-width":"max-content"});return e.watchPostEffect(()=>{t.value<0&&console.log("is open"),l.value.size<0&&console.log("empty selection");var c=H(r.value),d=H(null);if(a.value&&["absolute","relative","fixed","sticky"].includes(getComputedStyle(a.value).position))var d=H(a.value);let u=-d.left+c.left;const y=window.document.documentElement.clientWidth;u+s.value>y&&(u=y-s.value),m.value={position:"absolute","min-width":"max-content",width:s.value.toString()+"px",top:(-d.top+c.top+c.height).toString()+"px",left:u.toString()+"px"}}),{dropdownStyle:m,getTextWidth:g}},Me=["name"],Fe={key:1,class:"extra-select selection"},Ae=["onClick"],ze=["innerHTML"],De=["value","disabled"],$e={key:0,class:"input-searching"},Pe=["placeholder"],Re={key:0,class:"allselect-clear"},We={class:"row-input"},He=["checked"],Ie={class:"row-input"},qe=["checked"],je={key:1,class:"no-matches"},Ue={key:2},Ge=["onClick"],Je={class:"row-input"},Ke=["checked"],Xe=["value"],Ye=e.defineComponent({name:"ExtraSelect",inheritAttrs:!1,__name:"ExtraSelect",props:{modelValue:{default:()=>[]},originalNode:{},multiple:{type:Boolean},options:{default:()=>[]},localization:{default:()=>({})},url:{},maxWidth:{default:"dynamic"},minChars:{default:0},search:{type:Boolean},searchableUrl:{type:Boolean},initialValue:{},showSelected:{type:Boolean},fetchMode:{default:"limited"},fetchOptions:{default:()=>({})},filterFields:{default:()=>[]},hardFilterFields:{default:()=>[]},removeIcon:{default:"X"},dropdownContainer:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(n,{emit:l}){var me,he;const t=n,r=e.computed(()=>{var p;return((p=t.originalNode)==null?void 0:p.multiple)??t.multiple}),{options:o,selectedOptions:a,onReset:f}=re(t.originalNode,e.toRef(t,"options"),e.toRef(t,"modelValue"),t.initialValue),{t:i}=ie(t.originalNode,e.toRef(t,"localization")),g=(me=t.originalNode)==null?void 0:me.classList,s=Object.values(((he=t.originalNode)==null?void 0:he.style)??{});ae(t.originalNode);const m=l,c=(p,h=null)=>{if(r.value){let E=h;switch(E==null&&(E=!a.value.has(p)),E){case!0:a.value.set(p,p);break;case!1:a.value.delete(p);break}}else a.value.clear(),h!==!1&&a.value.set(p,p),O.value=!1;$(Array.from(a.value.keys()))},{filterText:d,filteredOptions:u,filterValues:y}=ue(o,a,c,t.filterFields,t.hardFilterFields),{searchingFlag:w}=de(o,t.url,t.searchableUrl,d,t.minChars,y,t.fetchMode,t.fetchOptions),k=e.ref(null),B=e.ref(),V=e.ref(null),O=e.ref(!1);function R(p){t.disabled||(O.value=p)}e.watch(d,()=>{var h;let p=(h=B.value)==null?void 0:h.querySelector(".scroller");p&&(p.scrollTop=0)});const T=e.ref(null),D=function(p){const h=A(p.target);h.push(p.target),!h.includes(k.value)&&!h.includes(B.value)?O.value=!1:(p.stopImmediatePropagation(),p.preventDefault())};e.onMounted(()=>{if(t.dropdownContainer!=null){const p=t.dropdownContainer;let h=!1;T.value=A(k.value).find(E=>!!(E instanceof Element&&(E.matches(p)&&(h=!0),h&&["absolute","relative","fixed","sticky"].includes(getComputedStyle(E).position))))}if(T.value==null&&(T.value=document.querySelector("body")),t.originalNode){for(let h of g)h!="extraselect"&&k.value.classList.add(h);for(let h of s)k.value.style[h]=t.originalNode.style[h];let p=A(k.value,"form").pop();p instanceof HTMLElement&&p.matches("form")&&p.addEventListener("reset",()=>setTimeout(f)),t.originalNode.toggleValue=c,t.originalNode.setValues=h=>{a.value.clear();for(let E of h)c(E)}}window.document.addEventListener("mousedown",D),window.document.addEventListener("focusin",D)}),e.onUnmounted(()=>{window.document.removeEventListener("mousedown",D),window.document.removeEventListener("focusin",D)});const{dropdownStyle:G,getTextWidth:I}=fe(o,a,O,k,B,T,t.maxWidth),$=p=>{e.nextTick(()=>{var h;return(h=t.originalNode)==null?void 0:h.dispatchEvent(new Event("change",{bubbles:!0}))}),m("update:modelValue",p)},S=p=>{v(p,!1),d.value=""},v=(p,h=null)=>{h==null&&(h=!C.value),h?(a.value.clear(),o.value.forEach(E=>a.value.set(E.key,E.key))):a.value.clear(),$(Array.from(a.value.keys()))},x=()=>{pe.value?u.value.forEach(p=>{a.value.has(p.key)&&a.value.delete(p.key)}):u.value.forEach(p=>{a.value.has(p.key)||a.value.set(p.key,p.key)}),$(Array.from(a.value.keys()))};e.watch(O,(p,h)=>{p!=h&&(p?t.search&&e.nextTick(()=>{V.value.focus({focusVisible:!0})}):d.value="")});const C=e.computed(()=>a.value.size==o.value.length),pe=e.computed(()=>u.value.reduce((p,h)=>p&&a.value.has(h.key),!0)),at=e.computed(()=>a.value.size==0),rt=e.computed(()=>{var p,h,E;if(o.value.length<0)return"";if(r.value){if(at.value)return i("No selection");if(!t.searchableUrl&&C.value)return i("All selected");const L=k.value?getComputedStyle(k.value):null,b=((p=k.value)==null?void 0:p.clientWidth)-parseInt(L==null?void 0:L.paddingLeft)-parseInt(L==null?void 0:L.paddingRight);let M=i(":n selected - ",{n:a.value.size}),W=!0;for(let dt of a.value)if(W?W=!1:M+=", ",M+=((h=o.map.get(dt[0]))==null?void 0:h.value)??(w.value?i("Loading..."):i("Value not found")),b<I(M))return a.value.size+i(" selected");return M}else for(let L of a.value)return((E=o.map.get(L[0]))==null?void 0:E.value)??(w.value?i("Loading..."):i("Value not found"));return i("No selection")}),{list:st,containerProps:it,wrapperProps:ct}=X(u,{itemHeight:32});return(p,h)=>{var E,L;return e.openBlock(),e.createElementBlock(e.Fragment,null,[r.value&&e.unref(a).size==0?(e.openBlock(),e.createElementBlock("input",{key:0,type:"hidden",name:(L=(E=t.originalNode)==null?void 0:E.name)==null?void 0:L.replace("[]",""),value:""},null,8,Me)):e.createCommentVNode("",!0),t.showSelected?(e.openBlock(),e.createElementBlock("div",Fe,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),b=>{var M;return e.openBlock(),e.createElementBlock("div",{key:b,onClick:e.withModifiers(W=>c(b[0]),["stop","prevent"]),class:"selection-badge"},[e.createTextVNode(e.toDisplayString((M=e.unref(o).find(W=>W.key==b[0]))==null?void 0:M.value)+" ",1),e.createElementVNode("div",{class:"selection-remove",innerHTML:t.removeIcon},null,8,ze)],8,Ae)}),128))])):e.createCommentVNode("",!0),e.createElementVNode("input",e.mergeProps({onFocus:h[0]||(h[0]=b=>R(!0)),onClick:h[1]||(h[1]=e.withModifiers(b=>R(!0),["stop","prevent"])),ref_key:"inputNode",ref:k,value:rt.value,class:"extra-select extra-select-input",readonly:""},p.$attrs,{disabled:p.disabled}),null,16,De),T.value?(e.openBlock(),e.createBlock(e.Teleport,{key:2,to:T.value},[e.withDirectives(e.createElementVNode("div",{class:e.normalizeClass(["extra-select dropdown",{searching:e.unref(w)>0}]),ref_key:"dropdownNode",ref:B,style:e.normalizeStyle(e.unref(G))},[t.search?(e.openBlock(),e.createElementBlock("div",$e,[e.withDirectives(e.createElementVNode("input",{ref_key:"searchNode",ref:V,class:"extra-select-search","onUpdate:modelValue":h[2]||(h[2]=b=>e.isRef(d)?d.value=b:null),type:"text",autocomplete:"off",autocorrect:"off",autocapitilize:"off",spellcheck:"false",placeholder:e.unref(i)("Search...")},null,8,Pe),[[e.vModelText,e.unref(d)]])])):e.createCommentVNode("",!0),e.unref(d).length>=t.minChars?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[r.value?(e.openBlock(),e.createElementBlock("div",Re,[e.unref(d).length==0?(e.openBlock(),e.createElementBlock("div",{key:0,onClick:e.withModifiers(v,["stop","prevent"]),class:"all-select"},[e.createElementVNode("div",We,[e.createElementVNode("input",{checked:C.value,type:"checkbox"},null,8,He),e.createElementVNode("b",null,e.toDisplayString(e.unref(i)("Select all")),1)])])):e.createCommentVNode("",!0),e.unref(u).length>0&&e.unref(d).length>0?(e.openBlock(),e.createElementBlock("div",{key:1,onClick:e.withModifiers(x,["stop","prevent"]),class:"all-select"},[e.createElementVNode("div",Ie,[e.createElementVNode("input",{checked:pe.value,type:"checkbox"},null,8,qe),e.createElementVNode("b",null,e.toDisplayString(e.unref(i)("Select Filtered")),1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"clear",onClick:e.withModifiers(S,["stop","prevent"])},e.toDisplayString(e.unref(i)("Clear")),1)])):e.createCommentVNode("",!0),e.unref(u).length==0?(e.openBlock(),e.createElementBlock("div",je,e.toDisplayString(e.unref(i)("No matches found")),1)):e.createCommentVNode("",!0)],64)):(e.openBlock(),e.createElementBlock("div",Ue,e.toDisplayString(e.unref(i)("Insert at least :n characters",{n:t.minChars})),1)),e.createElementVNode("div",e.mergeProps(e.unref(it),{class:"scroller"}),[e.createElementVNode("div",e.normalizeProps(e.guardReactiveProps(e.unref(ct))),[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(st),b=>(e.openBlock(),e.createElementBlock("button",{key:b.index,class:"dropdown-row",onClick:e.withModifiers(M=>c(b.data.key),["stop","prevent"]),style:{height:"32px"}},[e.createElementVNode("div",Je,[r.value?(e.openBlock(),e.createElementBlock("input",{key:0,checked:e.unref(a).has(b.data.key),type:"checkbox"},null,8,Ke)):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(b.data.value),1)])],8,Ge))),128))],16)],16)],6),[[e.vShow,O.value]])],8,["to"])):e.createCommentVNode("",!0),t.originalNode?(e.openBlock(),e.createBlock(e.Teleport,{key:3,to:t.originalNode},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),b=>(e.openBlock(),e.createElementBlock("option",{key:b[0],selected:"selected",value:b[0]},null,8,Xe))),128))],8,["to"])):e.createCommentVNode("",!0)],64)}}}),Qe=["disabled"],Ze={key:0,class:"no-matches"},et={key:1},tt=["onClick"],nt={class:"row-input"},lt=Object.assign({name:"ExtraSuggest",inheritAttrs:!1},{props:{originalNode:{type:Object,required:!1},options:{type:Array,required:!1},localization:{type:Object,required:!1,default:{}},modelValue:{type:String,required:!1},maxWidth:{type:String,default:"dynamic"},url:{type:String,required:!1},searchableUrl:{type:Boolean,default:!1},minChars:{type:Number,default:0},fetchMode:{type:String,default:"limited"},fetchOptions:{type:Object,default:{}},filterFields:{type:Array,default:[]},hardFilterFields:{type:Array,default:[]},dropdownContainer:{type:String,default:null},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:l}){var I,$;const t=n,{options:r}=re(t.originalNode,e.toRef(t,"options"),e.ref([])),{t:o}=ie(t.originalNode,e.toRef(t,"localization")),a=(I=t.originalNode)==null?void 0:I.classList,f=Object.values((($=t.originalNode)==null?void 0:$.style)??{});ae(t.originalNode);const i=l,g=(S,v=null)=>{v===!1?s.value="":s.value=r.map.get(S).value,w.value=!1},{filterText:s,filteredOptions:m,filterValues:c}=ue(r,null,g,t.filterFields,t.hardFilterFields),{searchingFlag:d}=de(r,t.url,t.searchableUrl,s,t.minChars,c,t.fetchMode,t.fetchOptions),u=e.ref(null),y=e.ref(null),w=e.ref(!1),k=e.ref(null);function B(S){t.disabled||(w.value=S)}e.watch(s,()=>{y.value.querySelector(".scroller").scrollTop=0});const V=function(S){const v=A(S.target);v.push(S.target),!v.includes(u.value)&&!v.includes(y.value)&&(w.value=!1)};e.onMounted(()=>{if(t.dropdownContainer){let x=!1;k.value=A(u.value).find(C=>!!(C instanceof Element&&(C.matches(t.dropdownContainer)&&(x=!0),x&&["absolute","relative","fixed","sticky"].includes(getComputedStyle(C).position))))}if(k.value==null&&(k.value=document.querySelector("body")),t.originalNode){for(let C of a)C!="extrasuggest"&&u.value.classList.add(C);for(let C of f)u.value.style[C]=t.originalNode.style[C];s.value=t.originalNode.value;let x=A(u.value,"form").pop();x instanceof HTMLElement&&x.matches("form")&&x.addEventListener("reset",()=>setTimeout(v)),t.originalNode.addEventListener("change",()=>{R(!0)})}e.watchEffect(()=>{t.modelValue!=null&&(s.value=t.modelValue)});const S=s.value,v=()=>{s.value=S};window.document.addEventListener("mousedown",V),window.document.addEventListener("focusin",V)}),e.onUnmounted(()=>{window.document.removeEventListener("mousedown",V),window.document.removeEventListener("focusin",V)});const{dropdownStyle:O}=fe(r,e.ref([]),w,u,y,k,t.maxWidth),R=(S=!1)=>{var v;t.originalNode&&(S?s.value=t.originalNode.value:(t.originalNode.value=s.value,(v=t.originalNode)==null||v.dispatchEvent(new Event("change",{bubbles:!0})))),i("update:modelValue",s.value)};e.watch(()=>w.value,S=>{S===!1&&R()});const{list:T,containerProps:D,wrapperProps:G}=X(m,{itemHeight:32});return(S,v)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({onFocus:v[0]||(v[0]=x=>B(!0)),onClick:v[1]||(v[1]=x=>B(!0)),ref_key:"inputNode",ref:u,"onUpdate:modelValue":v[2]||(v[2]=x=>e.isRef(s)?s.value=x:null),class:"extra-select extra-select-input"},S.$attrs,{disabled:n.disabled}),null,16,Qe),[[e.vModelDynamic,e.unref(s)]]),k.value?(e.openBlock(),e.createBlock(e.Teleport,{key:0,to:k.value},[e.withDirectives(e.createElementVNode("div",{class:e.normalizeClass(["extra-select dropdown",{searching:e.unref(d)>0}]),ref_key:"dropdownNode",ref:y,style:e.normalizeStyle(e.unref(O))},[e.unref(s).length>=t.minChars?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.unref(m).length==0?(e.openBlock(),e.createElementBlock("div",Ze,e.toDisplayString(e.unref(o)("No matches found")),1)):e.createCommentVNode("",!0)],64)):(e.openBlock(),e.createElementBlock("div",et,e.toDisplayString(e.unref(o)("Insert at least :n characters",{n:t.minChars})),1)),e.createElementVNode("div",e.mergeProps(e.unref(D),{class:"scroller"}),[e.createElementVNode("div",e.normalizeProps(e.guardReactiveProps(e.unref(G))),[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(T),x=>(e.openBlock(),e.createElementBlock("button",{key:x.index,class:"dropdown-row",onClick:e.withModifiers(C=>g(x.data.key),["stop","prevent"]),style:{height:"32px"}},[e.createElementVNode("div",nt,e.toDisplayString(x.data.value),1)],8,tt))),128))],16)],16)],6),[[e.vShow,w.value]])],8,["to"])):e.createCommentVNode("",!0)],64))}}),ot=q,j={init:function(){document.querySelectorAll(".extraselect").forEach(function(n){j.bindNew(n)})},bindNew(n){N.lock(n,"extra-select",()=>{const l={};for(let o in n.dataset)try{l[o]=JSON.parse(n.dataset[o])}catch{l[o]=n.dataset[o]}l.disabled=n.disabled,l.originalNode=n;const t=document.createElement("div");n.parentNode.insertBefore(t,n.nextSibling),t.dataset.isVue=!0,t.style.display="contents";const r=e.createApp(Ye,l);r.mount(t),n.addEventListener("remove",function(){r.unmount(),t.remove(),n.remove(),N.remove(n,"extra-select")})})}},U={init:function(){document.querySelectorAll(".extrasuggest").forEach(function(n){U.bindNew(n)})},bindNew(n){N.lock(n,"extra-suggest",()=>{const l={};for(let o in n.dataset)try{l[o]=JSON.parse(n.dataset[o])}catch{l[o]=n.dataset[o]}l.disabled=n.disabled,l.originalNode=n;const t=document.createElement("div");n.parentNode.insertBefore(t,n.nextSibling),t.dataset.isVue=!0,t.style.display="contents";const r=e.createApp(lt,l);r.mount(t),n.addEventListener("remove",function(){r.unmount(),t.remove(),n.remove(),N.remove(n,"extra-suggest")})})}};return document.addEventListener("DOMContentLoaded",function(){j.init(),U.init(),q()}),P.ExtraSelect=j,P.ExtraSuggest=U,P.loadExtraSelectDefaultLocalization=ot,Object.defineProperty(P,Symbol.toStringTag,{value:"Module"}),P}({},Vue);
