var Extraselect=function($,e){"use strict";const _=new WeakMap;class L{static put(l,t,r){_.has(l)||_.set(l,new Map),_.get(l).set(t,r)}static get(l,t){return _.get(l).get(t)}static has(l,t){return _.has(l)&&_.get(l).has(t)}static remove(l,t){var r=_.get(l).delete(t);return _.get(l).size!==0&&_.delete(l),r}static lock(l,t,r){if(!L.has(l,t)){L.put(l,t,!0);const o=r();return o!==void 0&&L.put(l,t,o),o}return!1}static async lockAsync(l,t,r){if(!L.has(l,t)){L.put(l,t,!0);const o=await r();return o!==void 0&&L.put(l,t,o),o}return!1}}({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}).DATASTORE_DEBUG&&(window.__Store=_);function R(n){if(n==null)return{top:0,left:0,width:null,height:null};let l=n.getBoundingClientRect();return{top:l.top+window.scrollY,left:l.left+window.scrollX,width:l.width,height:l.height}}function A(n,l){l===void 0&&(l=window.document);for(var t=[],r=n.parentNode;r!=null&&r instanceof HTMLElement&&!(l instanceof HTMLElement&&r===l)&&!(typeof l=="string"&&r.matches(l));){var o=r;t.push(o),r=o.parentNode}return r!=null&&t.push(r),t}function ge(n){var l=Array.prototype.slice.call(n.childNodes);l.forEach(function(t){n.removeChild(t)})}function ye(n){return e.getCurrentScope()?(e.onScopeDispose(n),!0):!1}function K(n){return typeof n=="function"?n():e.unref(n)}const we=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;function ke(n){return e.getCurrentInstance()}function ve(n,l=!0,t){ke()?e.onMounted(n,t):l?n():e.nextTick(n)}const X=we?window:void 0;function z(n){var l;const t=K(n);return(l=t==null?void 0:t.$el)!=null?l:t}function Ee(){const n=e.ref(!1),l=e.getCurrentInstance();return l&&e.onMounted(()=>{n.value=!0},l),n}function be(n){const l=Ee();return e.computed(()=>(l.value,!!n()))}function Se(n,l,t={}){const{window:r=X,...o}=t;let a;const u=be(()=>r&&"ResizeObserver"in r),c=()=>{a&&(a.disconnect(),a=void 0)},y=e.computed(()=>{const i=K(n);return Array.isArray(i)?i.map(d=>z(d)):[z(i)]}),s=e.watch(y,i=>{if(c(),u.value&&r){a=new ResizeObserver(l);for(const d of i)d&&a.observe(d,o)}},{immediate:!0,flush:"post"}),f=()=>{c(),s()};return ye(f),{isSupported:u,stop:f}}function xe(n,l={width:0,height:0},t={}){const{window:r=X,box:o="content-box"}=t,a=e.computed(()=>{var i,d;return(d=(i=z(n))==null?void 0:i.namespaceURI)==null?void 0:d.includes("svg")}),u=e.ref(l.width),c=e.ref(l.height),{stop:y}=Se(n,([i])=>{const d=o==="border-box"?i.borderBoxSize:o==="content-box"?i.contentBoxSize:i.devicePixelContentBoxSize;if(r&&a.value){const p=z(n);if(p){const g=p.getBoundingClientRect();u.value=g.width,c.value=g.height}}else if(d){const p=Array.isArray(d)?d:[d];u.value=p.reduce((g,{inlineSize:m})=>g+m,0),c.value=p.reduce((g,{blockSize:m})=>g+m,0)}else u.value=i.contentRect.width,c.value=i.contentRect.height},t);ve(()=>{const i=z(n);i&&(u.value="offsetWidth"in i?i.offsetWidth:l.width,c.value="offsetHeight"in i?i.offsetHeight:l.height)});const s=e.watch(()=>z(n),i=>{u.value=i?l.width:0,c.value=i?l.height:0});function f(){y(),s()}return{width:u,height:c,stop:f}}function Y(n,l){const{containerStyle:t,wrapperProps:r,scrollTo:o,calculateRange:a,currentList:u,containerRef:c}="itemHeight"in l?Be(l,n):Ne(l,n);return{list:u,scrollTo:o,containerProps:{ref:c,onScroll:()=>{a()},style:t},wrapperProps:r}}function Q(n){const l=e.ref(null),t=xe(l),r=e.ref([]),o=e.shallowRef(n);return{state:e.ref({start:0,end:10}),source:o,currentList:r,size:t,containerRef:l}}function Z(n,l,t){return r=>{if(typeof t=="number")return Math.ceil(r/t);const{start:o=0}=n.value;let a=0,u=0;for(let c=o;c<l.value.length;c++){const y=t(c);if(a+=y,u=c,a>r)break}return u-o}}function ee(n,l){return t=>{if(typeof l=="number")return Math.floor(t/l)+1;let r=0,o=0;for(let a=0;a<n.value.length;a++){const u=l(a);if(r+=u,r>=t){o=a;break}}return o+1}}function te(n,l,t,r,{containerRef:o,state:a,currentList:u,source:c}){return()=>{const y=o.value;if(y){const s=t(n==="vertical"?y.scrollTop:y.scrollLeft),f=r(n==="vertical"?y.clientHeight:y.clientWidth),i=s-l,d=s+f+l;a.value={start:i<0?0:i,end:d>c.value.length?c.value.length:d},u.value=c.value.slice(a.value.start,a.value.end).map((p,g)=>({data:p,index:g+a.value.start}))}}}function ne(n,l){return t=>typeof n=="number"?t*n:l.value.slice(0,t).reduce((o,a,u)=>o+n(u),0)}function le(n,l,t,r){e.watch([n.width,n.height,l,t],()=>{r()})}function oe(n,l){return e.computed(()=>typeof n=="number"?l.value.length*n:l.value.reduce((t,r,o)=>t+n(o),0))}const Ce={horizontal:"scrollLeft",vertical:"scrollTop"};function ae(n,l,t,r){return o=>{r.value&&(r.value[Ce[n]]=t(o),l())}}function Ne(n,l){const t=Q(l),{state:r,source:o,currentList:a,size:u,containerRef:c}=t,y={overflowX:"auto"},{itemWidth:s,overscan:f=5}=n,i=Z(r,o,s),d=ee(o,s),p=te("horizontal",f,d,i,t),g=ne(s,o),m=e.computed(()=>g(r.value.start)),E=oe(s,o);le(u,l,c,p);const V=ae("horizontal",p,g,c),b=e.computed(()=>({style:{height:"100%",width:`${E.value-m.value}px`,marginLeft:`${m.value}px`,display:"flex"}}));return{scrollTo:V,calculateRange:p,wrapperProps:b,containerStyle:y,currentList:a,containerRef:c}}function Be(n,l){const t=Q(l),{state:r,source:o,currentList:a,size:u,containerRef:c}=t,y={overflowY:"auto"},{itemHeight:s,overscan:f=5}=n,i=Z(r,o,s),d=ee(o,s),p=te("vertical",f,d,i,t),g=ne(s,o),m=e.computed(()=>g(r.value.start)),E=oe(s,o);le(u,l,c,p);const V=ae("vertical",p,g,c),b=e.computed(()=>({style:{width:"100%",height:`${E.value-m.value}px`,marginTop:`${m.value}px`}}));return{calculateRange:p,scrollTo:V,containerStyle:y,wrapperProps:b,currentList:a,containerRef:c}}const M=n=>{let l=parseInt(n);return l==n?l:n},Ve=n=>{try{var l=JSON.parse(n);if(l&&typeof l=="object")return l}catch{}return n},Le=(n,l,t)=>{window.ExtraSelectOptions==null&&(window.ExtraSelectOptions={});const r={defaultArray:n.value,get:()=>n.value,push:(o,a,u=null)=>{parseInt(o)==o&&(o=parseInt(o));const c=n.map.get(o);if(c)c.value=a,c.data=u;else{let y={value:a,key:o,data:u};n.value.push(y),n.map.set(y.key,y)}},addRange:o=>{for(let a of o)n.actions.push(a.key,a.value,a.data)},remove:o=>{n.value.splice(n.value.findIndex(a=>a.key==o),1)},clear:()=>{n.value=[]},sort:(o=null)=>{o==null&&(o=(a,u)=>a.value.localeCompare(u.value)),n.value=n.value.sort(o)},setDefault:function(o){this.defaultArray=o},restoreDefault:function(){n.value=this.defaultArray},filter:function(o){},selection:{get(){return l.value},clear(){l.value.clear()},add(o){l.value.set(o,o)},remove(o){l.value.delete(o)}}};window.ExtraSelectOptions[t]=r,n.actions=r};let _e=1;const re=n=>{n&&(n.style.display="none",ge(n))},se=(n,l,t,r)=>{const o=e.ref(new Map);e.watchEffect(()=>{if(Array.isArray(t.value)){o.value.clear();for(let s of t.value)o.value.set(s,s)}});const a=e.ref([]);if(a.map=new Map,a.rebuildMap=()=>{if(a.map.clear(),a.value)for(let s of a.value)a.map.set(s.key,s)},e.watchEffect(()=>{l.value&&(a.value=l.value.map(s=>({...s,key:M(s.key)})),a.rebuildMap())}),n){if(o.value.clear(),n.matches("select")){for(let s of Array.apply(null,n.selectedOptions).map(f=>M(f.value)).filter(f=>f!=null))o.value.set(s,s);a.value=Array.apply(null,n.options).reduce((s,f)=>(s.push({value:f.text,key:M(f.value),data:Object.keys(f.dataset).reduce((i,d)=>(i[d]=Ve(f.dataset[d]),i),{})}),s),[])}if(n.matches("input")){let s=n.value;s!=null&&s.length>0&&(a.value=[{value:s,key:s}])}a.rebuildMap()}if(Array.isArray(r))for(let s of r)o.value.set(M(s),M(s));else r!=null&&o.value.set(M(r),M(r));let u=n==null?void 0:n.id;(u==null||u===""||u==0)&&(u="extraselect_"+(++_e).toString()),Le(a,o,u);const c=[];return o.value.forEach((s,f)=>{c.push([f,s])}),{options:a,selectedOptions:o,onReset:()=>{o.value.clear();for(let[s,f]of c)o.value.set(s,f)}}};e.ref({});function Oe(n,l={}){for(let t in l)n=n.replace(`:${t}`,l[t]);return n}const I=(n=null)=>{var r;window.ExtraSelectLocalization==null&&(window.ExtraSelectLocalization={});let t={...((r=window.ExtraSelectLocalization.defaults)==null?void 0:r.defaultArray)??{}};Object.assign(t,n??{}),ie(e.ref(t),"defaults")},ie=(n,l)=>{window.ExtraSelectLocalization==null&&(window.ExtraSelectLocalization={},I());const t={defaultArray:n.value,list:()=>n.value,get:r=>n.value[r]??null,push:(r,o)=>{n.value[r]=o}};window.ExtraSelectLocalization[l]=t,n.actions=t};let Te=0;const ce=(n,l)=>(ie(l,(n==null?void 0:n.id)??"extraselect_"+(++Te).toString()),{propLocalization:l,t:(r,o={})=>{let a=l.value[r]??window.ExtraSelectLocalization.defaults.get(r);return a==null&&(window.ExtraSelectLocalization.defaults.push(r,r),a=r),Oe(a,o)}}),de=async function(n,l=null,t={}){const r={method:"POST",credentials:"include",...t,headers:{"Content-Type":"application/json",...t.headers??{}},body:JSON.stringify({search:l,...t.body})};return await(await fetch(n,r)).json()},ue=(n,l,t,r,o,a,u="limited",c={})=>{const y=e.ref(0),s=e.ref(!1),f=e.computed(()=>s.value||y.value>0);if(l!=null&&l.length>0)if(t){const i=[];e.watchEffect(d=>{if(r.value.length>=o){let p=!0;switch(u){case"always":break;default:case"limited":p=!i.includes(r.value);break;case"complete":p=i.reduce((g,m)=>g&&!r.value.startsWith(m),!0);break}if(p){s.value=!0;const g=setTimeout(()=>{i.push(r.value),y.value+=1,c.body={...c.body,...a.value},de(l,r.value,c).then(m=>{n.actions.addRange(m),n.actions.sort(),y.value-=1,s.value=!1})},500);d(()=>{clearTimeout(g)})}}})}else de(l,null,c).then(i=>{n.actions.addRange(i),n.actions.sort()});return{searchingFlag:f}},fe=(n,l,t,r=[],o=[])=>{const a=e.ref(""),u=e.ref([]),c=e.ref({}),y={...r.reduce((f,i)=>(f[i]=!1,f),{}),...o.reduce((f,i)=>(f[i]=!0,f),{})};for(let f in y){let i=y[f],d=document.getElementById(f);c.value[f]=d==null?void 0:d.value,d&&d.addEventListener("change",p=>{c.value[f]=p.target.value,i&&e.nextTick(()=>{if(l!=null)for(let g of Array.from(l.value.keys()))u.value.find(m=>m.key==g)||t(g,!1);else u.value.find(g=>g.key==a.value)||t(a.value,!1)})})}const s=function(f,i){let d=f.value;return Object.keys(c.value).length>0&&(d=d.filter(p=>{var g;for(let m in c.value)if((y[m]?!0:(c.value[m]??"").length>0)&&((g=p.data)!=null&&g.hasOwnProperty(m))){if(Array.isArray(p.data[m])){if(!p.data[m].includes(c.value[m]))return!1}else if(p.data[m]!=c.value[m])return!1}return!0})),i.length>0&&(d=d.filter(p=>p.value.toLowerCase().includes(i.toLowerCase()))),d};return e.watchEffect(()=>{u.value=s(n,a.value)}),{filterText:a,filteredOptions:u,filterValues:c}},pe=(n,l,t,r,o,a,u)=>{const c=getComputedStyle(document.querySelector("body")).font,y=function(i){const p=document.createElement("canvas").getContext("2d");return p.font=c,p.measureText(i).width},s=e.computed(()=>{const i=R(r.value).width??100;if(u==="inherit")return i;if(u==null||u==="dynamic"){const d=parseInt(getComputedStyle(document.querySelector("html"))["font-size"])??16;return Math.max(i,Math.max(...n.value.map(p=>y(p.value)))+20+d*3)}return u}),f=e.ref({position:"absolute","min-width":"max-content"});return e.watchPostEffect(()=>{var i=R(r.value);const d=r.value.getBoundingClientRect();var p=R(null);if(a.value&&["absolute","relative","fixed","sticky"].includes(getComputedStyle(a.value).position))var p=R(a.value);let g=-p.left+i.left;const m=window.document.documentElement.clientWidth;d.left+s.value>m&&(g=m-s.value);const E=window.document.documentElement.clientHeight;let V=-p.top+i.top+i.height,b=250;if(d.top+d.height+b>E){let F=i.top-b;F>0&&(V=F)}f.value={position:"absolute","min-width":"max-content",width:s.value.toString()+"px",top:(V-p.top).toString()+"px",left:g.toString()+"px"}}),{dropdownStyle:f,getTextWidth:y}},Me=["name"],Fe={key:1,class:"extra-select selection"},Ae=["onClick"],ze=["innerHTML"],De=["value","disabled"],$e={key:0,class:"input-searching"},Pe=["placeholder"],Re={key:0,class:"allselect-clear"},He={class:"row-input"},We=["checked"],Ie={class:"row-input"},qe=["checked"],je={key:1,class:"no-matches"},Ue={key:2},Ge=["onClick"],Je={class:"row-input"},Ke=["checked"],Xe=["value"],Ye=e.defineComponent({name:"ExtraSelect",inheritAttrs:!1,__name:"ExtraSelect",props:{modelValue:{default:()=>[]},originalNode:{default:null},multiple:{type:Boolean},options:{default:()=>[]},localization:{default:()=>({})},url:{},maxWidth:{default:"dynamic"},minChars:{default:0},search:{type:Boolean},searchableUrl:{type:Boolean},initialValue:{},showSelected:{type:Boolean},fetchMode:{default:"limited"},fetchOptions:{default:()=>({})},filterFields:{default:()=>[]},hardFilterFields:{default:()=>[]},removeIcon:{default:"X"},dropdownContainer:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(n,{emit:l}){var he;const t=n,r=e.computed(()=>{var h;return((h=t.originalNode)==null?void 0:h.multiple)??t.multiple}),{options:o,selectedOptions:a,onReset:u}=se(t.originalNode,e.toRef(t,"options"),e.toRef(t,"modelValue"),t.initialValue),{t:c}=ce(t.originalNode,e.toRef(t,"localization")),y=Object.values(((he=t.originalNode)==null?void 0:he.style)??{});re(t.originalNode);const s=l,f=(h,w=null)=>{if(r.value){let k=w;switch(k==null&&(k=!a.value.has(h)),k){case!0:a.value.set(h,h);break;case!1:a.value.delete(h);break}}else a.value.clear(),w!==!1&&a.value.set(h,h),b.value=!1;v(Array.from(a.value.keys()))},{filterText:i,filteredOptions:d,filterValues:p}=fe(o,a,f,t.filterFields,t.hardFilterFields),{searchingFlag:g}=ue(o,t.url,t.searchableUrl,i,t.minChars,p,t.fetchMode,t.fetchOptions),m=e.ref(),E=e.ref(),V=e.ref(null),b=e.ref(!1);function F(h){t.disabled||(b.value=h)}e.watch(i,()=>{var w;let h=(w=E.value)==null?void 0:w.querySelector(".scroller");h&&(h.scrollTop=0)});const O=e.ref(null),D=function(h){const w=A(h.target);w.push(h.target),!w.includes(m.value)&&!w.includes(E.value)?b.value=!1:(h.stopImmediatePropagation(),h.preventDefault())};e.onMounted(()=>{var h;if(t.dropdownContainer!=null){const w=t.dropdownContainer;let k=!1;O.value=A(m.value).find(S=>!!(S instanceof Element&&(S.matches(w)&&(k=!0),k&&["absolute","relative","fixed","sticky"].includes(getComputedStyle(S).position))))}if(O.value==null&&(O.value=document.querySelector("body")),t.originalNode){for(let k of t.originalNode.classList)k!="extraselect"&&((h=m.value)==null||h.classList.add(k));for(let k of y)m.value&&(m.value.style[k]=t.originalNode.style[k]);let w=A(m.value,"form").pop();w instanceof HTMLElement&&w.matches("form")&&w.addEventListener("reset",()=>setTimeout(u)),Object.assign(t.originalNode,{toggleValue:f,setValues:k=>{a.value.clear();for(let S of k)f(S)}})}window.document.addEventListener("mousedown",D),window.document.addEventListener("focusin",D)}),e.onUnmounted(()=>{window.document.removeEventListener("mousedown",D),window.document.removeEventListener("focusin",D)});const{list:U,containerProps:G,wrapperProps:H}=Y(d,{itemHeight:32}),{dropdownStyle:W,getTextWidth:C}=pe(o,a,b,m,E,O,t.maxWidth),v=h=>{e.nextTick(()=>{var w;return(w=t.originalNode)==null?void 0:w.dispatchEvent(new Event("change",{bubbles:!0}))}),s("update:modelValue",h)},N=h=>{B(h,!1),i.value=""},B=(h,w=null)=>{w==null&&(w=!J.value),w?(a.value.clear(),o.value.forEach(k=>a.value.set(k.key,k.key))):a.value.clear(),v(Array.from(a.value.keys()))},at=()=>{me.value?d.value.forEach(h=>{a.value.has(h.key)&&a.value.delete(h.key)}):d.value.forEach(h=>{a.value.has(h.key)||a.value.set(h.key,h.key)}),v(Array.from(a.value.keys()))};e.watch(b,(h,w)=>{h!=w&&(h?t.search&&e.nextTick(()=>{V.value.focus({focusVisible:!0})}):i.value="")});const J=e.computed(()=>a.value.size==o.value.length),me=e.computed(()=>d.value.reduce((h,w)=>h&&a.value.has(w.key),!0)),rt=e.computed(()=>a.value.size==0),st=e.computed(()=>{var h,w,k;if(o.value.length<0)return"";if(r.value){if(rt.value)return c("No selection");if(!t.searchableUrl&&J.value)return c("All selected");const S=m.value?getComputedStyle(m.value):null,x=((h=m.value)==null?void 0:h.clientWidth)-parseInt(S==null?void 0:S.paddingLeft)-parseInt(S==null?void 0:S.paddingRight);let T=c(":n selected - ",{n:a.value.size}),P=!0;for(let it of a.value)if(P?P=!1:T+=", ",T+=((w=o.map.get(it[0]))==null?void 0:w.value)??(g.value?c("Loading..."):c("Value not found")),x<C(T))return a.value.size+c(" selected");return T}else for(let S of a.value)return((k=o.map.get(S[0]))==null?void 0:k.value)??(g.value?c("Loading..."):c("Value not found"));return c("No selection")});return(h,w)=>{var k,S;return e.openBlock(),e.createElementBlock(e.Fragment,null,[r.value&&e.unref(a).size==0?(e.openBlock(),e.createElementBlock("input",{key:0,type:"hidden",name:(S=(k=t.originalNode)==null?void 0:k.name)==null?void 0:S.replace("[]",""),value:""},null,8,Me)):e.createCommentVNode("",!0),t.showSelected?(e.openBlock(),e.createElementBlock("div",Fe,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),x=>{var T;return e.openBlock(),e.createElementBlock("div",{key:x,onClick:e.withModifiers(P=>f(x[0]),["stop","prevent"]),class:"selection-badge"},[e.createTextVNode(e.toDisplayString((T=e.unref(o).find(P=>P.key==x[0]))==null?void 0:T.value)+" ",1),e.createElementVNode("div",{class:"selection-remove",innerHTML:t.removeIcon},null,8,ze)],8,Ae)}),128))])):e.createCommentVNode("",!0),e.createElementVNode("input",e.mergeProps({onFocus:w[0]||(w[0]=x=>F(!0)),onClick:w[1]||(w[1]=e.withModifiers(x=>F(!0),["stop","prevent"])),ref_key:"inputNode",ref:m,value:st.value,class:"extra-select extra-select-input",readonly:""},h.$attrs,{disabled:h.disabled}),null,16,De),O.value?(e.openBlock(),e.createBlock(e.Teleport,{key:2,to:O.value},[e.withDirectives(e.createElementVNode("div",{class:e.normalizeClass(["extra-select dropdown",{searching:e.unref(g)>0}]),ref_key:"dropdownNode",ref:E,style:e.normalizeStyle(e.unref(W))},[t.search?(e.openBlock(),e.createElementBlock("div",$e,[e.withDirectives(e.createElementVNode("input",{ref_key:"searchNode",ref:V,class:"extra-select-search","onUpdate:modelValue":w[2]||(w[2]=x=>e.isRef(i)?i.value=x:null),type:"text",autocomplete:"off",autocorrect:"off",autocapitilize:"off",spellcheck:"false",placeholder:e.unref(c)("Search...")},null,8,Pe),[[e.vModelText,e.unref(i)]])])):e.createCommentVNode("",!0),e.unref(i).length>=t.minChars?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[r.value?(e.openBlock(),e.createElementBlock("div",Re,[e.unref(i).length==0?(e.openBlock(),e.createElementBlock("div",{key:0,onClick:e.withModifiers(B,["stop","prevent"]),class:"all-select"},[e.createElementVNode("div",He,[e.createElementVNode("input",{checked:J.value,type:"checkbox"},null,8,We),e.createElementVNode("b",null,e.toDisplayString(e.unref(c)("Select all")),1)])])):e.createCommentVNode("",!0),e.unref(d).length>0&&e.unref(i).length>0?(e.openBlock(),e.createElementBlock("div",{key:1,onClick:e.withModifiers(at,["stop","prevent"]),class:"all-select"},[e.createElementVNode("div",Ie,[e.createElementVNode("input",{checked:me.value,type:"checkbox"},null,8,qe),e.createElementVNode("b",null,e.toDisplayString(e.unref(c)("Select Filtered")),1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"clear",onClick:e.withModifiers(N,["stop","prevent"])},e.toDisplayString(e.unref(c)("Clear")),1)])):e.createCommentVNode("",!0),e.unref(d).length==0?(e.openBlock(),e.createElementBlock("div",je,e.toDisplayString(e.unref(c)("No matches found")),1)):e.createCommentVNode("",!0)],64)):(e.openBlock(),e.createElementBlock("div",Ue,e.toDisplayString(e.unref(c)("Insert at least :n characters",{n:t.minChars})),1)),e.createElementVNode("div",e.mergeProps(e.unref(G),{class:"scroller"}),[e.createElementVNode("div",e.normalizeProps(e.guardReactiveProps(e.unref(H))),[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(U),x=>(e.openBlock(),e.createElementBlock("button",{key:x.index,class:"dropdown-row",onClick:e.withModifiers(T=>f(x.data.key),["stop","prevent"]),style:{height:"32px"}},[e.createElementVNode("div",Je,[r.value?(e.openBlock(),e.createElementBlock("input",{key:0,checked:e.unref(a).has(x.data.key),type:"checkbox"},null,8,Ke)):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(x.data.value),1)])],8,Ge))),128))],16)],16)],6),[[e.vShow,b.value]])],8,["to"])):e.createCommentVNode("",!0),t.originalNode?(e.openBlock(),e.createBlock(e.Teleport,{key:3,to:t.originalNode},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),x=>(e.openBlock(),e.createElementBlock("option",{key:x[0],selected:"selected",value:x[0]},null,8,Xe))),128))],8,["to"])):e.createCommentVNode("",!0)],64)}}}),Qe=["disabled"],Ze={key:0,class:"no-matches"},et={key:1},tt=["onClick"],nt={class:"row-input"},lt=Object.assign({name:"ExtraSuggest",inheritAttrs:!1},{props:{originalNode:{type:Object,required:!1},options:{type:Array,required:!1},localization:{type:Object,required:!1,default:{}},modelValue:{type:String,required:!1},maxWidth:{type:String,default:"dynamic"},url:{type:String,required:!1},searchableUrl:{type:Boolean,default:!1},minChars:{type:Number,default:0},fetchMode:{type:String,default:"limited"},fetchOptions:{type:Object,default:{}},filterFields:{type:Array,default:[]},hardFilterFields:{type:Array,default:[]},dropdownContainer:{type:String,default:null},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:l}){var H,W;const t=n,{options:r}=se(t.originalNode,e.toRef(t,"options"),e.ref([])),{t:o}=ce(t.originalNode,e.toRef(t,"localization")),a=(H=t.originalNode)==null?void 0:H.classList,u=Object.values(((W=t.originalNode)==null?void 0:W.style)??{});re(t.originalNode);const c=l,y=(C,v=null)=>{v===!1?s.value="":s.value=r.map.get(C).value,m.value=!1},{filterText:s,filteredOptions:f,filterValues:i}=fe(r,null,y,t.filterFields,t.hardFilterFields),{searchingFlag:d}=ue(r,t.url,t.searchableUrl,s,t.minChars,i,t.fetchMode,t.fetchOptions),p=e.ref(null),g=e.ref(null),m=e.ref(!1),E=e.ref(null);function V(C){t.disabled||(m.value=C)}e.watch(s,()=>{g.value.querySelector(".scroller").scrollTop=0});const b=function(C){const v=A(C.target);v.push(C.target),!v.includes(p.value)&&!v.includes(g.value)&&(m.value=!1)};e.onMounted(()=>{if(t.dropdownContainer){let N=!1;E.value=A(p.value).find(B=>!!(B instanceof Element&&(B.matches(t.dropdownContainer)&&(N=!0),N&&["absolute","relative","fixed","sticky"].includes(getComputedStyle(B).position))))}if(E.value==null&&(E.value=document.querySelector("body")),t.originalNode){for(let B of a)B!="extrasuggest"&&p.value.classList.add(B);for(let B of u)p.value.style[B]=t.originalNode.style[B];s.value=t.originalNode.value;let N=A(p.value,"form").pop();N instanceof HTMLElement&&N.matches("form")&&N.addEventListener("reset",()=>setTimeout(v)),t.originalNode.addEventListener("change",()=>{O(!0)})}e.watchEffect(()=>{t.modelValue!=null&&(s.value=t.modelValue)});const C=s.value,v=()=>{s.value=C};window.document.addEventListener("mousedown",b),window.document.addEventListener("focusin",b)}),e.onUnmounted(()=>{window.document.removeEventListener("mousedown",b),window.document.removeEventListener("focusin",b)});const{dropdownStyle:F}=pe(r,e.ref([]),m,p,g,E,t.maxWidth),O=(C=!1)=>{var v;t.originalNode&&(C?s.value=t.originalNode.value:(t.originalNode.value=s.value,(v=t.originalNode)==null||v.dispatchEvent(new Event("change",{bubbles:!0})))),c("update:modelValue",s.value)};e.watch(()=>m.value,C=>{C===!1&&O()});const{list:D,containerProps:U,wrapperProps:G}=Y(f,{itemHeight:32});return(C,v)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({onFocus:v[0]||(v[0]=N=>V(!0)),onClick:v[1]||(v[1]=N=>V(!0)),ref_key:"inputNode",ref:p,"onUpdate:modelValue":v[2]||(v[2]=N=>e.isRef(s)?s.value=N:null),class:"extra-select extra-select-input"},C.$attrs,{disabled:n.disabled}),null,16,Qe),[[e.vModelDynamic,e.unref(s)]]),E.value?(e.openBlock(),e.createBlock(e.Teleport,{key:0,to:E.value},[e.withDirectives(e.createElementVNode("div",{class:e.normalizeClass(["extra-select dropdown",{searching:e.unref(d)>0}]),ref_key:"dropdownNode",ref:g,style:e.normalizeStyle(e.unref(F))},[e.unref(s).length>=t.minChars?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.unref(f).length==0?(e.openBlock(),e.createElementBlock("div",Ze,e.toDisplayString(e.unref(o)("No matches found")),1)):e.createCommentVNode("",!0)],64)):(e.openBlock(),e.createElementBlock("div",et,e.toDisplayString(e.unref(o)("Insert at least :n characters",{n:t.minChars})),1)),e.createElementVNode("div",e.mergeProps(e.unref(U),{class:"scroller"}),[e.createElementVNode("div",e.normalizeProps(e.guardReactiveProps(e.unref(G))),[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(D),N=>(e.openBlock(),e.createElementBlock("button",{key:N.index,class:"dropdown-row",onClick:e.withModifiers(B=>y(N.data.key),["stop","prevent"]),style:{height:"32px"}},[e.createElementVNode("div",nt,e.toDisplayString(N.data.value),1)],8,tt))),128))],16)],16)],6),[[e.vShow,m.value]])],8,["to"])):e.createCommentVNode("",!0)],64))}}),ot=I,q={init:function(){document.querySelectorAll(".extraselect").forEach(function(n){q.bindNew(n)})},bindNew(n){L.lock(n,"extra-select",()=>{const l={};for(let o in n.dataset)try{l[o]=JSON.parse(n.dataset[o])}catch{l[o]=n.dataset[o]}l.disabled=n.disabled,l.originalNode=n;const t=document.createElement("div");n.parentNode.insertBefore(t,n.nextSibling),t.dataset.isVue=!0,t.style.display="contents";const r=e.createApp(Ye,l);r.mount(t),n.addEventListener("remove",function(){r.unmount(),t.remove(),n.remove(),L.remove(n,"extra-select")})})}},j={init:function(){document.querySelectorAll(".extrasuggest").forEach(function(n){j.bindNew(n)})},bindNew(n){L.lock(n,"extra-suggest",()=>{const l={};for(let o in n.dataset)try{l[o]=JSON.parse(n.dataset[o])}catch{l[o]=n.dataset[o]}l.disabled=n.disabled,l.originalNode=n;const t=document.createElement("div");n.parentNode.insertBefore(t,n.nextSibling),t.dataset.isVue=!0,t.style.display="contents";const r=e.createApp(lt,l);r.mount(t),n.addEventListener("remove",function(){r.unmount(),t.remove(),n.remove(),L.remove(n,"extra-suggest")})})}};return document.addEventListener("DOMContentLoaded",function(){q.init(),j.init(),I()}),$.ExtraSelect=q,$.ExtraSuggest=j,$.loadExtraSelectDefaultLocalization=ot,Object.defineProperty($,Symbol.toStringTag,{value:"Module"}),$}({},Vue);
